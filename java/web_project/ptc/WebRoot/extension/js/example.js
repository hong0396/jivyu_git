
var option;
//var series;
//var geoCoord;
var BMapExt;
var container;
var myChart; 
var map;
var json={};
(function () {
    require.config({
        paths: {
            echarts: '../../extension/js'
        },
        packages: [
            {
                name: 'BMap',
                location: '../../extension/js',
                main: 'main'
            }
        ]
    });
    
    require(
    [
        'echarts',
        'BMap',
        'echarts/chart/map'
    ],
    function (echarts, BMapExtension) {
        $('#main').css({
           // height:$('body').height(),
           // width: $('body').width()
        });

        // 初始化地图
        BMapExt = new BMapExtension($('#main')[0], BMap, echarts,{  enableMapClick: false   });
        map = BMapExt.getMap();
        container = BMapExt.getEchartsContainer();

        var startPoint = {
			
            x: 121.480237,
            y: 31.236058
        };
      
        var point = new BMap.Point(startPoint.x, startPoint.y);
        map.centerAndZoom(point, 13);
        map.enableScrollWheelZoom(true);
      
    
      
        
        
        // 地图自定义样式
        map.setMapStyle({
            styleJson: [
                  {
                       "featureType": "water",
                       "elementType": "all",
                       "stylers": {
                            "color": "#044161"
                       }
                  },
                  {
                       "featureType": "land",
                       "elementType": "all",
                       "stylers": {
                            "color": "#004981"
                       }
                  },
                  {
                       "featureType": "boundary",
                       "elementType": "geometry",
                       "stylers": {
                            "color": "#064f85"
                       }
                  },
                  {
                       "featureType": "railway",
                       "elementType": "all",
                       "stylers": {
                            "visibility": "off"
                       }
                  },
                  {
                       "featureType": "highway",
                       "elementType": "geometry",
                       "stylers": {
                            "color": "#004981"
                       }
                  },
                  {
                       "featureType": "highway",
                       "elementType": "geometry.fill",
                       "stylers": {
                            "color": "#005b96",
                            "lightness": 1
                       }
                  },
                  {
                       "featureType": "highway",
                       "elementType": "labels",
                       "stylers": {
                            "visibility": "off"
                       }
                  },
                  {
                       "featureType": "arterial",
                       "elementType": "geometry",
                       "stylers": {
                            "color": "#004981"
                       }
                  },
                  {
                       "featureType": "arterial",
                       "elementType": "geometry.fill",
                       "stylers": {
                            "color": "#00508b"
                       }
                  },
                  {
                       "featureType": "poi",
                       "elementType": "all",
                       "stylers": {
                            "visibility": "off"
                       }
                  },
                  {
                       "featureType": "green",
                       "elementType": "all",
                       "stylers": {
                            "color": "#056197",
                            "visibility": "off"
                       }
                  },
                  {
                       "featureType": "subway",
                       "elementType": "all",
                       "stylers": {
                            "visibility": "on"
                       }
                  },
                  {
                       "featureType": "manmade",
                       "elementType": "all",
                       "stylers": {
                            "visibility": "off"
                       }
                  },
                  {
                       "featureType": "local",
                       "elementType": "all",
                       "stylers": {
                            "visibility": "off"
                       }
                  },
                  {
                       "featureType": "arterial",
                       "elementType": "labels",
                       "stylers": {
                            "visibility": "off"
                       }
                  },
                  {
                       "featureType": "boundary",
                       "elementType": "geometry.fill",
                       "stylers": {
                            "color": "#029fd4"
                       }
                  },
                  {
                       "featureType": "building",
                       "elementType": "all",
                       "stylers": {
                            "color": "#1a5787"
                       }
                  },
                  {
                       "featureType": "label",
                       "elementType": "all",
                       "stylers": {
                            "visibility": "off"
                       }
                  }
            ]
        });

       option = {
	
		   
  
		   
            color: ['gold','aqua','lime','aqua','gold'],
            title : {
                text: '',
                subtext:'',
                x:'right',
                textStyle : {
                    color: '#fff'
                }
            },
            tooltip : {
                trigger: 'item',
                formatter: function (v) {
              
                   return v[1].replace(':','>')+" "+v[2];
                	
                    
                }
            },
         /*   legend: {
                orient: 'vertical',
                x:'left',
                data:['上海','中山公园','人民广场'],
				selectedMode: 'single',         
			
                selected:{	
					'中山公园':false,
					'人民广场':false
                },
                textStyle : {
                    color: '#fff'
                }
            },*/
            toolbox: {
                show : true,
                orient : 'vertical',
                x: 'right',
                y: 'center',
                feature : {
                    mark : {show: true},
                    dataView : {show: true, readOnly: false},
                    restore : {show: true},
                    saveAsImage : {show: true}
                }
            },
            dataRange: {
                min : 0,
                max : 1000,
                x: 'right',
                calculable : true,
                color: ['#ff3333', 'orange', 'yellow','lime','aqua'],
                textStyle:{
                    color:'#fff'
                }
            },
            series : [
                {
                    name:'上海X',
                    type:'map',
                    mapType: 'none',
                    data:[],
                    selectedMode : 'single',
                    geoCoord:json,

                    markLine : {
                        smooth:true,
                        effect : {
                            show: true,
                            scaleSize: 1,
                            period: 30,
                            color: '#fff',
                            shadowBlur: 10
                        },
                        itemStyle : {
                            normal: {
                                borderWidth:1,
                                lineStyle: {
                                    type: 'solid',
                                    shadowBlur: 10
                                }
                            }
                        },
                        data : [
								
							]
                    }
                }
            ]
        };

        myChart = BMapExt.initECharts(container);
        BMapExt.setOption(option);
        /***********************11111111111111111111**************************************************/
        var latlons={
            '上海': [121.4648,31.2891],  
        	'星中路':[121.375571,31.163862],
      	'合川路':[121.391169,31.172226],
      	'漕河泾开发区':[121.404164,31.176220],
      	'桂林路':[121.424982,31.181001],
      	'宜山路':[121.433340,31.193035],
      	'徐家汇':[121.442314,31.201202],
      	'肇嘉浜路':[121.456680,31.205020],
      	'嘉善路':[121.467219,31.208945],
      	'打浦桥':[121.475402,31.212073],
      	'马当路':[121.483698,31.215194],
      	'小南门':[121.504895,31.222656],
      	'商城路':[121.522890,31.236125],
      	'杨高中路':[121.555022,31.233791],
      	'航中路':[121.361249,31.171619],
      	'紫藤路':[121.370970,31.175533],
      	'龙柏新村':[121.376990,31.182886],
      	'虹桥1号航站楼':[121.353900,31.197476],
      	'上海动物园':[121.373597,31.196049],
      	'龙溪路':[121.386467,31.199878],
      	'水城路':[121.398444,31.205074],
      	'伊犁路':[121.410671,31.204634],
      	'宋园路':[121.418434,31.202693],
      	'虹桥路':[121.427305,31.203491],
      	'交通大学':[121.441394,31.208906],
      	'上海图书馆':[121.450771,31.214439],
      	'陕西南路':[121.464538,31.220995],
      	'新天地':[121.481813,31.222245],
      	'豫园':[121.493900,31.234005],
      	'南京东路':[121.490320,31.242899],
      	'天潼路':[121.488864,31.249675],
      	'四川北路':[121.490774,31.257732],
      	'海伦路':[121.495103,31.264929],
      	'邮电新村':[121.500859,31.274187],
      	'同济大学':[121.513050,31.288214],
      	'国权路':[121.516743,31.295352],
      	'五角场':[121.521191,31.303805],
      	'江湾体育场':[121.520633,31.308746],
      	'三门路':[121.514701,31.318613],
      	'殷高东路':[121.513177,31.327743],
      	'新江湾城':[121.513188,31.334451],
      	'花桥':[121.110679,31.304843],
      	'光明路':[121.123995,31.302118],
      	'兆丰路':[121.156829,31.294656],
      	'安亭':[121.168598,31.294337],
      	'上海汽车城':[121.187250,31.291581],
      	'昌吉东路':[121.206771,31.299940],
      	'上海赛车场':[121.232625,31.337944],
      	'嘉定北':[121.244010,31.397409],
      	'嘉定西':[121.234404,31.383236],
      	'白银路':[121.251801,31.351371],
      	'嘉定新城':[121.261040,31.335744],
      	'马陆':[121.283430,31.325402],
      	'南翔':[121.329748,31.303357],
      	'桃浦新村':[121.355937,31.287647],
      	'武威路':[121.371318,31.282825],
      	'祁连山路':[121.382499,31.277205],
      	'李子园':[121.396533,31.274628],
      	'上海西站':[121.407940,31.268542],
      	'真如':[121.413834,31.256497],
      	'枫桥路':[121.417540,31.248068],
      	'曹杨路':[121.424100,31.244107],
      	'隆德路':[121.430091,31.236727],
      	'江苏路':[121.437100,31.226732],
      	'上海游泳馆':[121.448026,31.185365],
      	'龙华':[121.459229,31.179259],
      	'云锦路':[121.464914,31.172650],
      	'龙耀路':[121.466000,31.166117],
      	'三林':[121.517556,31.148688],
      	'三林东':[121.529691,31.152393],
      	'浦三路':[121.545540,31.157148],
      	'御桥':[121.577365,31.164663],
      	'罗山路':[121.599723,31.159221],
      	'国际客运中心':[121.504856,31.255835],
      	'提篮桥':[121.513280,31.259141],
      	'江浦公园':[121.530286,31.270507],
      	'宁国路':[121.539069,31.274769],
      	'隆昌路':[121.550831,31.281347],
      	'爱国路':[121.559427,31.286351],
      	'复兴岛':[121.567831,31.287214],
      	'东陆路':[121.585248,31.288712],
      	'巨峰路':[121.596079,31.286157],
      	'杨高北路':[121.609423,31.285852],
      	'金京路':[121.622205,31.285413],
      	'申江路':[121.633793,31.285856],
      	'金海路':[121.645202,31.268949],
      	'金运路':[121.326035,31.247368],
      	'金沙江西路':[121.341690,31.247400],
      	'丰庄':[121.362183,31.248367],
      	'祁连山南路':[121.374173,31.243177],
      	'真北路':[121.388887,31.237862],
      	'大渡河路':[121.401707,31.237536],
      	'金沙江路':[121.418999,31.237230],
      	'武宁路':[121.436675,31.240291],
      	'龙阳路':[121.564089,31.208352],
      	'华夏中路':[121.589865,31.181184],
      	'周浦东':[121.613533,31.115800],
      	'鹤沙航城':[121.617792,31.083402],
      	'航头东':[121.624049,31.060692],
      	'新场':[121.655259,31.051489],
      	'野生动物园':[121.706186,31.056408],
      	'惠南':[121.768452,31.059659],
      	'惠南东':[121.799711,31.032764],
      	'书院':[121.857220,30.965002],
      	'书院':[121.857220,30.965002],
      	'临港大道':[121.916746,30.930354],
      	'滴水湖':[121.935987,30.913401],
      	'莘庄':[121.391623,31.116581],
      	'外环路':[121.399814,31.126929],
      	'莲花路':[121.409334,31.136734],
      	'锦江乐园':[121.420680,31.148312],
      	'上海南站':[121.436244,31.161166],
      	'漕宝路':[121.441499,31.174518],
      	'上海体育馆':[121.442832,31.188363],
      	'徐家汇':[121.442314,31.201202],
      	'衡山路':[121.453160,31.211335],
      	'常熟路':[121.457746,31.219921],
      	'陕西南路':[121.464538,31.220995],
      	'黄陂南路':[121.479798,31.228753],
      	'人民广场':[121.481690,31.238918],
      	'新闸路':[121.474802,31.244699],
      	'汉中路':[121.464956,31.247766],
      	'上海火车站':[121.462428,31.253647],
      	'中山北路':[121.465616,31.265275],
      	'延长路':[121.461893,31.278060],
      	'上海马戏城':[121.458503,31.285845],
      	'汶水路':[121.456560,31.298815],
      	'彭浦新村':[121.455097,31.312943],
      	'共康路':[121.453464,31.325355],
      	'通河新村':[121.447817,31.337798],
      	'呼兰路':[121.444185,31.345991],
      	'共富新村':[121.440458,31.361557],
      	'宝安公路':[121.437357,31.376207],
      	'友谊西路':[121.434336,31.387740],
      	'富锦路':[121.431030,31.398683],
      	'徐泾东':[121.307524,31.195431],
      	'虹桥火车站':[121.327907,31.200316],
      	'虹桥2号航站楼':[121.333274,31.200560],
      	'淞虹路':[121.365797,31.223998],
      	'北新泾':[121.380659,31.222130],
      	'威宁路':[121.393695,31.220465],
      	'娄山关路':[121.410793,31.216919],
      	'中山公园':[121.422231,31.223951],
      	'江苏路':[121.437100,31.226732],
      	'静安寺':[121.455101,31.229263],
      	'南京西路':[121.466780,31.236136],
      	'人民广场':[121.481690,31.238918],
      	'南京东路':[121.490320,31.242899],
      	'陆家嘴':[121.509075,31.243319],
      	'东昌路':[121.521998,31.239079],
      	'世纪大道':[121.533435,31.234850],
      	'上海科技馆':[121.550621,31.225524],
      	'世纪公园':[121.557176,31.215933],
      	'龙阳路':[121.564089,31.208352],
      	'张江高科':[121.594061,31.207879],
      	'金科路':[121.608557,31.209932],
      	'广兰路':[121.627183,31.216662],
      	'唐镇':[121.662625,31.219828],
      	'创新中路':[121.680337,31.219751],
      	'华夏东路':[121.687295,31.203168],
      	'川沙':[121.704499,31.192886],
      	'凌空路':[121.730308,31.198595],
      	'远东大道':[121.762160,31.205201],
      	'海天三路':[121.803224,31.174953],
      	'浦东国际机场':[121.812958,31.155679],
      	'上海南站':[121.436244,31.161166],
      	'石龙路':[121.449630,31.164304],
      	'龙漕路':[121.450819,31.175695],
      	'漕溪路':[121.444735,31.182971],
      	'宜山路':[121.433340,31.193035],
      	'虹桥路':[121.427305,31.203491],
      	'延安西路':[121.423584,31.215865],
      	'中山公园':[121.422231,31.223951],
      	'金沙江路':[121.418999,31.237230],
      	'曹杨路':[121.424100,31.244107],
      	'镇坪路':[121.437948,31.253361],
      	'中潭路':[121.447452,31.261022],
      	'上海火车站':[121.462428,31.253647],
      	'宝山路':[121.483032,31.257464],
      	'东宝兴路':[121.486639,31.265746],
      	'虹口足球场':[121.485658,31.277557],
      	'赤峰路':[121.488990,31.287038],
      	'大柏树':[121.489614,31.295096],
      	'江湾镇':[121.491636,31.311153],
      	'殷高西路':[121.491418,31.325557],
      	'长江南路':[121.498185,31.337669],
      	'淞发路':[121.507140,31.350804],
      	'张华浜':[121.505406,31.363662],
      	'淞滨路':[121.499387,31.376563],
      	'水产路':[121.494718,31.387101],
      	'宝杨路':[121.486126,31.401287],
      	'友谊路':[121.482540,31.409930],
      	'铁力路':[121.467851,31.414261],
      	'江杨北路':[121.446217,31.414218],
      	'上海体育馆':[121.442832,31.188363],
      	'宜山路':[121.433340,31.193035],
      	'海伦路':[121.495103,31.264929],
      	'临平路':[121.507604,31.266580],
      	'大连路':[121.519576,31.263723],
      	'杨树浦路':[121.523944,31.257681],
      	'浦东大道':[121.526013,31.245796],
      	'世纪大道':[121.533435,31.234850],
      	'浦电路':[121.535457,31.226050],
      	'蓝村路':[121.534258,31.217660],
      	'塘桥':[121.525353,31.215407],
      	'南浦大桥':[121.506336,31.214285],
      	'西藏南路':[121.496122,31.207672],
      	'鲁班路':[121.480988,31.204940],
      	'大木桥路':[121.470148,31.200335],
      	'东安路':[121.461154,31.197304],
      	'上海体育场':[121.450248,31.192180],
      	'春申路':[121.392332,31.103958],
      	'银都路':[121.396872,31.095083],
      	'颛桥':[121.408435,31.072842],
      	'北桥':[121.416485,31.051134],
      	'剑川路':[121.422973,31.032572],
      	'东川路':[121.426326,31.024468],
      	'金平路':[121.416554,31.017141],
      	'华宁路':[121.401635,31.013066],
      	'文井路':[121.387319,31.009198],
      	'闵行开发区':[121.376495,31.006315],
      	'东方体育中心':[121.487012,31.159351],
      	'灵岩南路':[121.501680,31.154367],
      	'上南路':[121.512956,31.154788],
      	'华夏西路':[121.521145,31.155570],
      	'高青路':[121.522270,31.165247],
      	'东明路':[121.517488,31.178250],
      	'高科西路':[121.516396,31.191286],
      	'临沂新村':[121.523080,31.198949],
      	'上海儿童医学中心':[121.529790,31.209399],
      	'蓝村路':[121.534258,31.217660],
      	'浦电路':[121.535457,31.226050],
      	'源深体育中心':[121.540892,31.239044],
      	'民生路':[121.549926,31.242115],
      	'北洋泾路':[121.559229,31.245588],
      	'德平路':[121.570573,31.251659],
      	'云山路':[121.579314,31.256659],
      	'金桥路':[121.588374,31.263292],
      	'博兴路':[121.593414,31.270058],
      	'五莲路':[121.594540,31.278007],
      	'巨峰路':[121.596079,31.286157],
      	'东靖路':[121.595327,31.296804],
      	'五洲大道':[121.595846,31.308625],
      	'洲海路':[121.595922,31.318355],
      	'外高桥保税南区':[121.608650,31.327224],
      	'航津路':[121.600539,31.341305],
      	'外高桥保税北区':[121.593437,31.353897],
      	'港城路':[121.581148,31.359297],
      	'美兰湖':[121.356426,31.407854],
      	'罗南新村':[121.364185,31.394383],
      	'潘广路':[121.362293,31.370197],
      	'刘行':[121.368889,31.363427],
      	'顾村公园':[121.379313,31.350576],
      	'祁华路':[121.380160,31.328108],
      	'上海大学':[121.395296,31.326259],
      	'南陈路':[121.405224,31.327225],
      	'上大路':[121.414775,31.321458],
      	'场中路':[121.420162,31.309963],
      	'大场镇':[121.422947,31.299710],
      	'行知路':[121.428059,31.291225],
      	'大华三路':[121.429488,31.280186],
      	'新村路':[121.429033,31.270157],
      	'岚皋路':[121.428339,31.262583],
      	'镇坪路':[121.437948,31.253361],
      	'长寿路':[121.444738,31.246257],
      	'昌平路':[121.448746,31.240476],
      	'静安寺':[121.455101,31.229263],
      	'常熟路':[121.457746,31.219921],
      	'肇嘉浜路':[121.456680,31.205020],
      	'东安路':[121.461154,31.197304],
      	'龙华中路':[121.463379,31.191311],
      	'后滩':[121.480035,31.177884],
      	'长清路':[121.492645,31.180330],
      	'云台路':[121.507267,31.187762],
      	'杨高南路':[121.531652,31.193453],
      	'锦绣路':[121.546398,31.193767],
      	'芳华路':[121.556478,31.199531],
      	'龙阳路':[121.564089,31.208352],
      	'花木路':[121.569227,31.217570],
      	'沈杜公路':[121.518803,31.067060],
      	'联航路':[121.517130,31.079655],
      	'江月路':[121.515133,31.089988],
      	'浦江镇':[121.512891,31.102197],
      	'芦恒路':[121.504377,31.124907],
      	'凌兆新村':[121.496279,31.146696],
      	'杨思':[121.500290,31.166710],
      	'成山路':[121.502730,31.176478],
      	'耀华路':[121.501124,31.184085],
      	'中华艺术宫':[121.500749,31.191340],
      	'西藏南路':[121.496122,31.207672],
      	'陆家浜路':[121.492716,31.217413],
      	'老西门':[121.489485,31.224674],
      	'大世界':[121.485885,31.233127],
      	'人民广场':[121.481690,31.238918],
      	'曲阜路':[121.478011,31.248303],
      	'中兴路':[121.475411,31.259035],
      	'西藏北路':[121.475250,31.269400],
      	'虹口足球场':[121.485658,31.277557],
      	'曲阳路':[121.497039,31.282122],
      	'四平路':[121.507831,31.280581],
      	'鞍山新村':[121.516066,31.278923],
      	'江浦路':[121.524804,31.280818],
      	'黄兴路':[121.534441,31.284573],
      	'延吉中路':[121.541405,31.294724],
      	'黄兴公园':[121.539677,31.301934],
      	'翔殷路':[121.538472,31.311024],
      	'嫩江路':[121.538559,31.320923],
      	'市光路':[121.538527,31.328516],
      	'松江南站':[121.237677,30.990955],
      	'醉白池':[121.235829,31.006987],
      	'松江体育中心':[121.237126,31.022049],
      	'松江新城':[121.237259,31.036209],
      	'松江大学城':[121.239201,31.060041],
      	'洞泾':[121.237014,31.090393],
      	'佘山':[121.236257,31.110609],
      	'泗泾':[121.267259,31.123976],
      	'九亭':[121.325378,31.143844],
      	'中春路':[121.344742,31.155955],
      	'七宝':[121.356030,31.161390]

      }
        /**********************222222222222222222********************************************/
     
     //   alert(latlons);
      
   	for(var k in latlons){
    		var points = new BMap.Point(latlons[k][0],latlons[k][1]);    		
    		json[k] = [latlons[k][0],latlons[k][1]];    	
    		//创建小狐狸    		
    		var myIcon = new BMap.Icon("../../extension/BMap/images/subwayicon.png", new BMap.Size(23,23));
    		
   	var marker = new BMap.Marker(points,{icon:myIcon});  // 创建标注
   	marker.setTitle(k);
   	map.addOverlay(marker);              // 将标注添加到地图中

    	
//      marker.addEventListener("mouseover",function(){setLb(this)});
//      marker.addEventListener("mouseout",function(){marker.setLabel();  });
        
  	}    
    function setLb(marker,k){
    	var label = new BMap.Label(k,{offset:new BMap.Size(20,-10)});
    	marker.setLabel(label);
    }
     /*******************************************************************************/
        
        
        
        
        
        
		// 动态添加默认不显示的数据
	/*	var ecConfig = require('echarts/config');
		myChart.on(ecConfig.EVENT.LEGEND_SELECTED, function (param){
		var selected = param.selected;

			if (selected['中山公园']) {
			 
			    alert('中山公园');
                }
			
		
			
				
				
});*/
		
		
							
    }								
							
		
							
	
);
})();